{{/* Modal Component */}}

{{/* Basic Modal with Alpine.js */}}
{{define "modal"}}
<div x-data="{open: false}"
     x-show="open"
     @keydown.escape.window="open = false"
     {{if .triggerEvent}}@{{.triggerEvent}}.window="open = true"{{end}}
     class="fixed inset-0 z-50 overflow-y-auto"
     style="display: none;">

    <!-- Backdrop -->
    <div x-show="open"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="open = false"
         class="fixed inset-0 bg-black/80 backdrop-blur-sm"></div>

    <!-- Modal Container -->
    <div class="flex min-h-full items-center justify-center p-4">
        <!-- Modal Content -->
        <div x-show="open"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-200"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             @click.stop
             class="relative glass-card w-full {{if .maxWidth}}{{.maxWidth}}{{else}}max-w-lg{{end}} {{.class}}">

            <!-- Header -->
            {{if or .title .showClose}}
            <div class="flex items-center justify-between border-b border-slate-800 pb-3 mb-4">
                {{if .title}}
                <h3 class="text-lg font-semibold text-white">{{.title}}</h3>
                {{end}}
                {{if ne .showClose false}}
                <button @click="open = false"
                        class="text-slate-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
                {{end}}
            </div>
            {{end}}

            <!-- Body -->
            <div class="{{if .bodyClass}}{{.bodyClass}}{{end}}">
                {{.content}}
            </div>

            <!-- Footer -->
            {{if .footer}}
            <div class="flex items-center justify-end gap-3 pt-4 border-t border-slate-800 mt-4">
                {{.footer}}
            </div>
            {{end}}
        </div>
    </div>
</div>
{{end}}

{{/* Confirm Dialog */}}
{{define "modal-confirm"}}
<div x-data="{
        open: false,
        title: '',
        message: '',
        confirmText: 'Confirm',
        cancelText: 'Cancel',
        onConfirm: null,
        show(options) {
            this.title = options.title || 'Confirm';
            this.message = options.message || 'Are you sure?';
            this.confirmText = options.confirmText || 'Confirm';
            this.cancelText = options.cancelText || 'Cancel';
            this.onConfirm = options.onConfirm;
            this.open = true;
        },
        confirm() {
            if (this.onConfirm) this.onConfirm();
            this.open = false;
        }
     }"
     x-show="open"
     @open-confirm.window="show($event.detail)"
     @keydown.escape.window="open = false"
     class="fixed inset-0 z-50 overflow-y-auto"
     style="display: none;">

    <!-- Backdrop -->
    <div x-show="open"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="open = false"
         class="fixed inset-0 bg-black/80 backdrop-blur-sm"></div>

    <div class="flex min-h-full items-center justify-center p-4">
        <div x-show="open"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-200"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             @click.stop
             class="relative glass-card w-full max-w-md">

            <div class="flex items-center gap-3 mb-4">
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-amber-500/20 flex items-center justify-center">
                    <svg class="w-6 h-6 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-white" x-text="title"></h3>
            </div>

            <p class="text-slate-300 mb-6" x-text="message"></p>

            <div class="flex items-center justify-end gap-3">
                <button @click="open = false"
                        class="btn-ghost"
                        x-text="cancelText"></button>
                <button @click="confirm()"
                        class="btn-destructive"
                        x-text="confirmText"></button>
            </div>
        </div>
    </div>
</div>
{{end}}

{{/* Alert Dialog */}}
{{define "modal-alert"}}
<div x-data="{
        open: false,
        title: '',
        message: '',
        type: 'info',
        show(options) {
            this.title = options.title || 'Alert';
            this.message = options.message || '';
            this.type = options.type || 'info';
            this.open = true;
        }
     }"
     x-show="open"
     @open-alert.window="show($event.detail)"
     @keydown.escape.window="open = false"
     class="fixed inset-0 z-50 overflow-y-auto"
     style="display: none;">

    <div x-show="open"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="open = false"
         class="fixed inset-0 bg-black/80 backdrop-blur-sm"></div>

    <div class="flex min-h-full items-center justify-center p-4">
        <div x-show="open"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-200"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             @click.stop
             class="relative glass-card w-full max-w-md">

            <div class="flex items-center gap-3 mb-4">
                <div class="flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center"
                     :class="{
                        'bg-emerald-500/20': type === 'success',
                        'bg-rose-500/20': type === 'error',
                        'bg-amber-500/20': type === 'warning',
                        'bg-blue-500/20': type === 'info'
                     }">
                    <svg class="w-6 h-6"
                         :class="{
                            'text-emerald-500': type === 'success',
                            'text-rose-500': type === 'error',
                            'text-amber-500': type === 'warning',
                            'text-blue-500': type === 'info'
                         }"
                         fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <template x-if="type === 'success'">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </template>
                        <template x-if="type === 'error'">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </template>
                        <template x-if="type === 'warning'">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </template>
                        <template x-if="type === 'info'">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </template>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-white" x-text="title"></h3>
            </div>

            <p class="text-slate-300 mb-6" x-text="message"></p>

            <div class="flex justify-end">
                <button @click="open = false" class="btn-primary">OK</button>
            </div>
        </div>
    </div>
</div>
{{end}}

{{/* Modal with Form */}}
{{define "modal-form"}}
<div x-data="{open: false}"
     x-show="open"
     @keydown.escape.window="open = false"
     {{if .triggerEvent}}@{{.triggerEvent}}.window="open = true"{{end}}
     class="fixed inset-0 z-50 overflow-y-auto"
     style="display: none;">

    <div x-show="open"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="open = false"
         class="fixed inset-0 bg-black/80 backdrop-blur-sm"></div>

    <div class="flex min-h-full items-center justify-center p-4">
        <div x-show="open"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-200"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             @click.stop
             class="relative glass-card w-full {{if .maxWidth}}{{.maxWidth}}{{else}}max-w-2xl{{end}}">

            <div class="flex items-center justify-between border-b border-slate-800 pb-3 mb-4">
                <h3 class="text-lg font-semibold text-white">{{.title}}</h3>
                <button @click="open = false"
                        class="text-slate-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <form {{if .hxPost}}hx-post="{{.hxPost}}"{{else}}action="{{.action}}" method="{{if .method}}{{.method}}{{else}}POST{{end}}"{{end}}
                  {{if .hxTarget}}hx-target="{{.hxTarget}}"{{end}}
                  {{if .hxSwap}}hx-swap="{{.hxSwap}}"{{end}}
                  @submit="if (!$event.target.checkValidity()) return; open = false">
                {{.content}}

                <div class="flex items-center justify-end gap-3 pt-4 border-t border-slate-800 mt-6">
                    <button type="button"
                            @click="open = false"
                            class="btn-ghost">
                        Cancel
                    </button>
                    <button type="submit" class="btn-primary">
                        {{if .submitText}}{{.submitText}}{{else}}Save{{end}}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{{end}}

{{/* Fullscreen Modal */}}
{{define "modal-fullscreen"}}
<div x-data="{open: false}"
     x-show="open"
     @keydown.escape.window="open = false"
     {{if .triggerEvent}}@{{.triggerEvent}}.window="open = true"{{end}}
     class="fixed inset-0 z-50"
     style="display: none;">

    <div x-show="open"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 bg-slate-950">

        <!-- Header -->
        <div class="flex items-center justify-between px-6 py-4 border-b border-slate-800">
            <h2 class="text-xl font-bold text-white">{{.title}}</h2>
            <button @click="open = false"
                    class="text-slate-400 hover:text-white transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>

        <!-- Content -->
        <div class="h-[calc(100vh-4rem)] overflow-y-auto p-6">
            {{.content}}
        </div>
    </div>
</div>
{{end}}
